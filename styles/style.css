:root {
  --bg: #0f1115; --panel: #171a21; --ink: #e8ecf1; --muted: #9aa4b2; --accent: #36c;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.6 system-ui,-apple-system,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background:#0c0e13;border-bottom:1px solid #1e222b}
.topbar h1{margin:0;font-size:18px;letter-spacing:.5px}
.status{display:flex;gap:12px;color:var(--muted)}

.layout{display:grid;grid-template-columns:1fr 300px;gap:16px;padding:16px}
.stage{position:relative;display:grid;place-items:center}
#game{background:#111;border:1px solid #2a2f3a;width:100%;height:auto;max-width:960px}

.overlay{position:absolute;inset:0;display:grid;place-items:center;text-align:center;font-weight:700;letter-spacing:1px;color:#fff;text-shadow:0 1px 4px rgba(0,0,0,.6);pointer-events:none}
.overlay.blink{animation:blink 1s steps(2,start) infinite}
.hidden{display:none}
@keyframes blink{50%{opacity:.2}}

.panel{background:var(--panel);border:1px solid #232836;border-radius:12px;padding:12px;height:fit-content;position:sticky;top:12px}
.panel h2,.panel h3{margin:6px 0 8px}
.row{display:grid;grid-template-columns:1fr 140px;gap:8px;align-items:center;margin:6px 0}
.row input[type="number"],.row input[type="text"],.row select,.row input[type="range"]{width:100%;padding:6px 8px;background:#0f121a;color:var(--ink);border:1px solid #2a2f3a;border-radius:8px}
.row input[type="range"]{padding:0}
.buttons{display:flex;gap:8px;margin-top:10px}
button{padding:8px 10px;border:0;border-radius:10px;color:#fff;background:var(--accent);cursor:pointer;font-weight:600}
button:active{transform:translateY(1px)}
hr{border:0;border-top:1px solid #2a2f3a;margin:12px 0}
.legend ul{margin:6px 0 0 20px;padding:0}
.legend li{margin:2px 0;color:var(--muted)}

/* ハンバーガー */
.hamburger{
  display:none; margin:0; padding:6px 10px; font-size:18px;
  border:1px solid #2a2f3a; border-radius:8px; background:#0f121a; color:#e8ecf1;
}

/* ドロワー共通 */
.drawer{ z-index:50 }
.backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.45);
  opacity:0; visibility:hidden; transition:opacity .2s; z-index:40;
}
.backdrop.show{ opacity:1; visibility:visible; }

/* ===== モバイル（幅<=900px） ===== */
@media (max-width: 900px){
  .layout{ grid-template-columns: 1fr; padding: 8px; }
  .topbar{ position:sticky; top:0; z-index:60 }
  .hamburger{ display:inline-block; }
  .status{ display:none } /* ステータスは省スペースのため隠す（必要なら残してOK） */

  .stage{ margin:0; }
  /* キャンバスを画面いっぱいに */
  #game{
    width:100vw; height:auto; max-width:100vw;
    border:1px solid #2a2f3a;
  }

  /* パネルは右側からスライドイン */
  .panel.drawer{
    position:fixed; right:0; top:48px; /* topbar 高さに合わせる */
    width:min(86vw, 340px);
    height:calc(100dvh - 48px);
    overflow:auto;
    transform:translateX(100%);
    transition:transform .25s ease;
  }
  .panel.drawer.open{ transform:translateX(0); }
}
